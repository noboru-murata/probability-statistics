<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>最尤推定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">最尤推定</h1>
</div>
<div class="talk-subtitle">
    <p>確率・統計 - 第9講</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org0d1969f">
<h2 id="org0d1969f">前回のおさらい</h2>
<ul>
<li>平均の点推定
<ul>
<li>点推定の考え方</li>
<li>良い不偏推定量</li>
<li>正規分布モデルの標本平均の性質</li>

</ul></li>
<li>平均の区間推定
<ul>
<li>区間推定の考え方</li>
<li>正規分布モデルにおける区間推定</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgd276b56">
<h3 id="orgd276b56">統計的推測の考え方</h3>
<ul>
<li>観測データは確率変数の集合</li>
<li>確率変数列 \(X_1,X_2,\dotsc,X_n\) に対する考察が重要</li>
<li>現象の理解のためには観測された実現値より確率分布にこそ興味がある</li>
<li>一般に分析対象のデータには
独立性と同分布性が同時に仮定される</li>
<li>観測データの背後の確率分布を推定
<ul>
<li>分布のもつ特性量(平均や分散など)を評価する</li>
<li>分布そのもの(確率質量関数や確率密度関数)を決定する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org0e16452">
<h3 id="org0e16452">点推定</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
点推定とは
母数(パラメタ) \(\theta\) を \(X_1,\dotsc,X_n\) の関数
</p>
<div>
\begin{equation}
  \hat{\theta}=\hat{\theta}(X_1,\dots,X_n)
\end{equation}

</div>

<p>
で推定することで，
\(\hat{\theta}\) を \(\theta\) の推定量と呼ぶ．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgd544a03">
<h3 id="orgd544a03">Cramer-Raoの不等式</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
1次元母数 \(\theta\) を含む連続分布を考え，
その確率密度関数 \(f_\theta(x)\) は \(\theta\) に関して
偏微分可能であるとする．
このとき，緩やかな仮定の下で，
\(\theta\) の任意の不偏推定量 \(\hat{\theta}\) に対して
以下の不等式が成り立つ．
</p>
<div>
\begin{equation}
  \mathrm{Var}(\hat{\theta})\ge \frac{1}{nI(\theta)},
\end{equation}

</div>
<div>
\begin{equation}
  I(\theta)=\int_{-\infty}^\infty
  \left(\frac{\partial}{\partial\theta}\log f_\theta(x)\right)^2
  f_\theta(x)dx.
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7a93b73">
<h3 id="org7a93b73">一様最小分散不偏推定量</h3>
<ul>
<li><p>
定理 (Cramer-Raoの不等式の系)
</p>
<blockquote>
<p>
\(\theta\) の不偏推定量 \(\hat{\theta}\) で
分散が Cramer-Rao 下界に一致するものが存在すれば，
一様最小分散不偏推定量となる．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7d6aeb2">
<h3 id="org7d6aeb2">推定誤差</h3>
<ul>
<li>推定量 \(\hat{\theta}\) には推定誤差が必ず存在</li>
<li>推定結果の定量評価には推定誤差の評価が重要
<ul>
<li><p>
&ldquo;誤差 \(\hat{\theta}-\theta\) が
区間 \([l,u]\) の内側にある確率が \(1{-}\alpha\) 以上 &rdquo; <br />
(&ldquo;外側にある確率が \(\alpha\) 以下&rdquo;)
</p>
<blockquote>
<div>
\begin{equation}
  P(l\le\hat{\theta}-\theta\le u)\ge 1{-}\alpha
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li>この確率の厳密あるいは近似的な評価を利用</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgffeebd5">
<h3 id="orgffeebd5">区間推定</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
区間推定とは
未知母数 \(\theta\) とある値 \(\alpha\in(0,1)\) に対して
以下を満たす確率変数 \(L,U\) を観測データから求めることをいう．
</p>
<div>
\begin{equation}
  P(L\le\theta\le U)\ge 1{-}\alpha
\end{equation}

</div>
</blockquote>
<ul>
<li>区間 \([L,U]\) : \(1{-}\alpha\) 信頼区間 (\(100(1{-}\alpha)\) % とも書く)</li>
<li>\(L\) : \(1{-}\alpha\) 下側信頼限界</li>
<li>\(U\) : \(1{-}\alpha\) 上側信頼限界</li>
<li>\(1{-}\alpha\) : 信頼係数
(\(\alpha=0.01,0.05,0.1\) など)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org08ccc7f">
<h3 id="org08ccc7f">加法的正規雑音モデル</h3>
<ul>
<li><p>
加法的雑音モデル
</p>
<blockquote>
<div>
\begin{equation}
  \begin{array}{c@{}c@{}c@{}c@{}cl}
    X_{i}&=&\theta&+&\varepsilon_{i},&i=1,\dotsc,n\\
    \text{(確率変数)}&&\text{(未知母数)}&&
					   \text{(誤差)}
  \end{array}
\end{equation}

</div>
</blockquote></li>
<li><p>
以下の仮定を加える
</p>
<blockquote>
<ul>
<li>\(\varepsilon_{1},\dotsc,\varepsilon_{n}\)
は平均0，分散 \(\sigma^{2}\) の正規分布に従う．</li>

</ul>
</blockquote></li>
<li><p>
観測値の分布
</p>
<blockquote>
<p>
このとき \(X\) は平均 \(\theta\) ，分散 \(\sigma^{2}\) の
正規分布に従う．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org0078890">
<h3 id="org0078890">標本平均</h3>
<ul>
<li>平均 \(\theta\) , 分散 \(\sigma^2\) の正規分布
<ul>
<li><p>
平均母数 \(\theta\) に関するFisher情報量 :
</p>
<div>
\begin{equation}
  I(\theta)
  =
  \frac{1}{\sigma^2}
\end{equation}

</div></li>

<li>標本平均 \(\bar{X}\) の分散: \(\sigma^2/n=\) Cramer-Rao下界</li>

</ul></li>
<li>\(\bar{X}\) は平均の一様最小分散不偏推定量</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb8a483b">
<h3 id="orgb8a483b">平均の区間推定</h3>
<ul>
<li><p>
分散既知の場合の信頼区間
</p>
<blockquote>
<p>
\(z_{1{-}\alpha/2}\) を標準正規分布の
\(1{-}\alpha/2\) 分位点とすれば
</p>
<div>
\begin{equation}
  P\Bigl(-z_{1{-}\alpha/2}\le\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
  \le z_{1{-}\alpha/2}\Bigr)=1{-}\alpha
\end{equation}

</div>

<p>
となるので，
\(\sigma\) が既知の場合の平均 \(\mu\) の \(1{-}\alpha\) 信頼区間は
以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}},\;
    \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\sigma}{\sqrt{n}}\right]
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgfb2ead3">
<h2 id="orgfb2ead3">最尤法</h2>
<div class="outline-text-2" id="text-orgfb2ead3">
</div>
</section>
<section id="slide-org5e3b168">
<h3 id="org5e3b168">離散分布の場合</h3>
<ul>
<li>観測値 \(X_1=x_1,X_2=x_2,\dots,X_n=x_n\) の同時確率
<ul>
<li>確率質量関数 : \(f_{\boldsymbol{\theta}}(x)\)</li>
<li>確率質量関数の母数 : \(\boldsymbol{\theta}=(\theta_1,\dots,\theta_p)\)</li>
<li><p>
独立な確率変数の同時確率 :
</p>
<blockquote>
<div>
\begin{align}
  & P(X_1=x_1,X_2=x_2,\dots,X_n=x_n)
    =\prod_{i=1}^nP(X_i=x_i)\\
  &=
    \prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
    =f_{\boldsymbol{\theta}}(x_1)\cdot
    f_{\boldsymbol{\theta}}(x_2)\cdots
    f_{\boldsymbol{\theta}}(x_n)
\end{align}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf70f17a">
<h3 id="orgf70f17a">尤度関数</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
母数 \(\boldsymbol{\theta}\) に対して
観測データ \(X_1,X_2,\dots,X_n\) が得られる理論上の確率
</p>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(X_i)
\end{equation}

</div>

<p>
を
\(\boldsymbol{\theta}\) の 
<b>尤度</b> と言い，
\(\boldsymbol{\theta}\) の関数 \(L\) を <b>尤度関数</b> と呼ぶ．
</p>
</blockquote>
<ul>
<li>観測データ 
\(X_1,X_2,\dots,X_n\) 
が現れるのに母数
\(\boldsymbol{\theta}\) 
の値がどの程度 <b>尤もらしいか</b> を測る尺度</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc78425a">
<h3 id="orgc78425a">連続分布の場合</h3>
<ul>
<li>確率密度関数 \(f_{\boldsymbol{\theta}}(x)\) を用いて尤度を定義</li>
<li><p>
<b>尤度関数</b> :
</p>
<blockquote>
<div>
\begin{equation}
  L(\boldsymbol{\theta})
  =\prod_{i=1}^nf_{\boldsymbol{\theta}}(x_i)
  =f_{\boldsymbol{\theta}}(x_1)\cdot
  f_{\boldsymbol{\theta}}(x_2)\cdots
  f_{\boldsymbol{\theta}}(x_n)
\end{equation}

</div>
</blockquote>
<ul>
<li>確率データ \(X_{i}\) が微小な区間
\([x_{i}-\delta,x_{i}+\delta]\)
に含まれる確率に比例する量</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org3fe3adf">
<h3 id="org3fe3adf">最尤法</h3>
<ul>
<li><p>
最尤法 : 
</p>
<blockquote>
<p>
観測データに対して「最も尤もらしい」母数の値
を \(\boldsymbol{\theta}\) の推定量として採用する方法
を <b>最尤法</b> という．
</p>
</blockquote></li>
<li><p>
最尤推定量 :
</p>
<blockquote>
<p>
\(\Theta\) を尤度関数の定義域として，
尤度関数を最大とする  \(\hat{\boldsymbol{\theta}}\) 
</p>
<div>
\begin{equation}
  L(\hat{\boldsymbol{\theta}})
  =\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>
<div>
\begin{equation}
  \hat{\boldsymbol{\theta}}
  =\arg\max_{\boldsymbol{\theta}\in\Theta}L(\boldsymbol{\theta}).
\end{equation}

</div>

<p>
を 
\(\boldsymbol{\theta}\) 
の <b>最尤推定量</b> という．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org33f86ca">
<h3 id="org33f86ca">最尤推定量の計算</h3>
<ul>
<li><p>
<b>対数尤度関数</b> :
</p>
<blockquote>
<p>

</p>

<div>
\begin{equation}
  \ell(\boldsymbol{\theta})
  =\log L(\boldsymbol{\theta})
  =\sum_{i=1}^n\log f_{\boldsymbol{\theta}}(X_i).
\end{equation}

</div>
</blockquote>
<ul>
<li>対数関数は狭義増加</li>
<li>\(\ell(\boldsymbol{\theta})\) の最大化と \(L(\boldsymbol{\theta})\) の最大化は同義</li>
<li>扱い易い和の形なのでこちらを用いることが多い</li>
<li>大数の法則を用いて対数尤度関数の収束が議論できる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgb3b23c9" data-background="#fef4f4">
<h2 id="orgb3b23c9">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org83dcf80" data-background="#fef4f4">
<h3 id="org83dcf80">練習問題</h3>
<ul>
<li>観測データ \(X_{1},X_{2},\dotsc,X_{n}\) が以下の分布に従うとき
母数 \(\lambda\) の最尤推定量を求めよ．
<ul>
<li><p>
\(\lambda>0\) の Poisson 分布 (確率質量関数)
</p>
<blockquote>
<div>
\begin{equation}
  f(x)
  =
  \frac{\lambda^{x}}{x!}e^{-\lambda}
  \quad
  (x\text{は0以上の整数})
\end{equation}

</div>
</blockquote></li>
<li><p>
\(\lambda>0\) の指数分布 (確率密度関数)
</p>
<blockquote>
<div>
\begin{equation}
  f(x)
  =
  \lambda e^{-\lambda x}
  \quad
  (x>0)
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgde1b186" data-background="#fef4f4">
<h3 id="orgde1b186">解答例 : Poisson分布の最尤推定</h3>
<ul>
<li><p>
対数尤度関数 (未知母数 : \(\lambda\) )
</p>
<blockquote>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\frac{\lambda^{X_i}}{X_i!}e^{-\lambda}
  =\sum_{i=1}^n(X_i\log\lambda-\log X_i!)-n\lambda
\end{equation}

</div>
</blockquote>
<ul>
<li>少なくとも1つの \(i\) について \(X_i>0\) を仮定する</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
\(\ell(\lambda)\) の微分 :
</p>
<blockquote>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{1}{\lambda}\sum_{i=1}^nX_i-n,\quad
  \ell''(\lambda)=-\frac{1}{\lambda^2}\sum_{i=1}^nX_i<0
\end{equation}

</div>
</blockquote></li>
<li>上に凸なので方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量 :
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgdd9e90d" data-background="#fef4f4">
<h3 id="orgdd9e90d">解答例 : 指数分布の最尤推定</h3>
<ul>
<li><p>
対数尤度関数 (未知母数 : \(\lambda\) )
</p>
<blockquote>
<div>
\begin{equation}
  \ell(\lambda)=\sum_{i=1}^n\log\lambda e^{-\lambda X_i}
  =n\log\lambda-\lambda\sum_{i=1}^nX_i
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
\(\ell(\lambda)\) の微分 :
</p>
<blockquote>
<div>
\begin{equation}
  \ell'(\lambda)=\frac{n}{\lambda}-\sum_{i=1}^nX_i,\quad
  \ell''(\lambda)=-\frac{n}{\lambda^2}<0
\end{equation}

</div>
</blockquote></li>
<li>方程式 \(\ell'(\lambda)=0\) の解が \(\ell(\lambda)\) を最大化</li>
<li><p>
\(\lambda\) の最尤推定量 :
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\lambda}=\frac{1}{\frac{1}{n}\sum_{i=1}^nX_i}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc7ac119" data-background="#fef4f4">
<h3 id="orgc7ac119">参考 : ガンマ分布の最尤推定</h3>
<ul>
<li>母数 \(\nu,\alpha>0\) のガンマ分布 (調べてみよ)</li>
<li><p>
対数尤度関数 (未知母数: \(\nu,\alpha\) )
</p>
<blockquote>
<div>
\begin{align}
  \ell(\nu,\alpha)
  &=\sum_{i=1}^n\log\frac{\alpha^\nu}{\Gamma(\nu)}X_i^{\nu{-}1}e^{-\alpha X_i}\\
  &=n\nu\log\alpha-n\log\Gamma(\nu)+\sum_{i=1}^n\{(\nu{-}1)\log X_i-\alpha X_i\}
\end{align}

</div>
</blockquote>
<ul>
<li>\(\ell(\nu,\alpha)\) を最大化する \(\nu,\alpha\) は解析的に求まらないので実際の計算では数値的に求める</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgd61a336">
<h2 id="orgd61a336">最尤推定量の性質</h2>
<div class="outline-text-2" id="text-orgd61a336">
</div>
</section>
<section id="slide-orgd373a86">
<h3 id="orgd373a86">一致性</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
全ての \(x\) に対して \(f(x)>0\) で
\(f\) が連続ならば，最尤推定量 \(\hat\theta^*\) は
一致推定量になる．
すなわち，
真の母数の値が \(\theta_0\) のとき，
任意の \(\varepsilon>0\) に対して
</p>
<div>
\begin{equation}
  P\left(|\hat\theta^*-\theta_0|<\varepsilon\right)
  \to1\quad(n\to\infty)
\end{equation}

</div>

<p>
が成り立つ．
</p>
</blockquote>
<ul>
<li>観測データが十分多ければ，
最尤推定量は真の値に一致する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org6a1bdb4">
<h3 id="org6a1bdb4">証明の概略</h3>
<ul>
<li><p>
対数尤度の大数の法則
</p>
<blockquote>
<div>
\begin{equation}
  \frac{1}{n}\log L(\theta)
  \rightarrow^{n\to\infty}
  \mathbb{E}_{\theta_0}[\log f(X,\theta)]
\end{equation}

</div>
</blockquote>
<ul>
<li>\(\mathbb{E}_{\theta_0}\) は真の母数 (\(X\)を生成している分布) での平均を表す</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
対数密度・質量の性質
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}_{\theta_0}[\log f(X,\theta)]
  \le
  \mathbb{E}_{\theta_0}[\log f(X,\theta_{0})]
\end{equation}

</div>
</blockquote>
<ul>
<li>対数関数の凸性を用いて証明 (資料参照)</li>
<li><p>
情報理論のエントロピー (平均符号長) とも関係
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}_{\theta_0}[-\log f(X,\theta)]
  \ge
  \mathbb{E}_{\theta_0}[-\log f(X,\theta_{0})]
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
対数尤度の性質
</p>
<blockquote>
<p>
\(n\) が十分大きければ
</p>
<div>
\begin{equation}
  \frac{1}{n}\log L(\theta)
  \le
  \frac{1}{n}\log L(\theta_{0})
\end{equation}

</div>

<p>
がほぼ確実に成り立つ
</p>
</blockquote>
<ul>
<li>\(n\) が大きければ，真の値で対数尤度は最大になる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org22851dc">
<h3 id="org22851dc">漸近正規性</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
\(f(x)>0\)
が連続で2階微分可能ならば
\(\sqrt{n}(\hat\theta^*-\theta_0)\)
は
\(n\to\infty\)
で正規分布
\(\mathcal{N}(0,I(\theta_0)^{-1})\)
に近づく．
</p>
</blockquote>
<ul>
<li>\(I(\theta_0)\) は Fisher 情報量</li>
<li>観測データが十分多ければ，
最尤推定量の誤差の分散は
Cramer-Rao 下界に一致する</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgbdc27b7">
<h3 id="orgbdc27b7">証明の概略</h3>
<ul>
<li><p>
真の母数の性質
</p>
<blockquote>
<div>
\begin{equation}
  \mathbb{E}_{\theta_0}\left[
    \frac{\partial}{\partial\theta}\log f(X,\theta_0)\right]
  =0
\end{equation}

</div>
</blockquote></li>
<li><p>
Fisher 情報量 (以下が等しいことは講義資料を参照)
</p>
<blockquote>
<div>
\begin{align}
  I(\theta_0)
  &=\mathbb{E}_{\theta_0}
    \left[
    -\frac{\partial^2}{\partial\theta^2}\log f(X,\theta_0)
    \right]
  \\
  &=\mathbb{E}_{\theta_0}\left[\left(
    \frac{\partial}{\partial\theta}\log f(X,\theta_0)\right)^2\right]
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
最大値の性質
</p>
<blockquote>
<div>
\begin{equation}
  L(\hat\theta^*)=\max_{\theta\in\Theta}L(\theta)
\end{equation}

</div>
<div>
\begin{equation}
  \ell(\hat\theta^*)=\max_{\theta\in\Theta}\ell(\theta)
\end{equation}

</div>
<div>
\begin{equation}
  \frac{\partial}{\partial\theta}\ell(\hat\theta^*)
  =\sum_{i=1}^n\frac{\partial}{\partial\theta}\log f(X_i,\hat\theta^*)
  =0
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
Taylor 展開による近似
</p>
<blockquote>
<div>
\begin{equation}
  \sum_{i=1}^n\frac{\partial}{\partial\theta}\log f(X_i,\theta_0)
  +(\hat\theta^*-\theta_0)
  \sum_{i=1}^n\frac{\partial^2}{\partial\theta^2}\log f(X_i,\tilde\theta)
  =0
\end{equation}

</div>
</blockquote>
<ul>
<li>\(\tilde\theta\)
は
\(\{X_i\}\) に依存して決まる
\(\theta_0\)
と
\(\hat\theta^*\)
の間の値</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
誤差の近似
</p>
<blockquote>
<div>
\begin{align}
  \sqrt{n}(\hat\theta^*-\theta_0)
  \left\{-\frac{1}{n}\sum_{i=1}^n
  \frac{\partial^2}{\partial\theta^2}\log f(X_i,\tilde\theta)
  \right\}\qquad&\\
  =
  \frac{1}{\sqrt{n}}\sum_{i=1}^n
  \frac{\partial}{\partial\theta}\log f(X_i,\theta_0)&
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
左辺
</p>
<blockquote>
<p>
\(n\)
が大きくなると
\(\tilde\theta\to\theta_0\)
となり，大数の法則により以下が成り立つ．
</p>
<div>
\begin{align}
  &-\frac{1}{n}\sum_{i=1}^n
    \frac{\partial^2}{\partial\theta^2}\log f(X_i,\tilde\theta)\\
  &\qquad\to
    \mathbb{E}_{\theta_0}\left[
    -\frac{\partial^2}{\partial\theta^2}\log f(X_i,\theta_0)\right]
    =I(\theta_0)
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
右辺
</p>
<blockquote>
<p>
\(n\to\infty\)
のとき中心極限定理により右辺
</p>
<div>
\begin{align}
  &\frac{1}{\sqrt{n}}\sum_{i=1}^n
    \frac{\partial}{\partial\theta}\log f(X_i,\theta_0)\\
  &=
    \sqrt{n}\times
    \frac{1}{n}\sum_{i=1}^n
    \frac{\partial}{\partial\theta}\log f(X_i,\theta_0)\\
  &=
    \sqrt{n}\times
    \left(\frac{\partial}{\partial\theta}\log f(X,\theta_0)
    \text{の標本平均}\right)
\end{align}

</div>

<p>
は
平均 \(0\) 分散 \(I(\theta_0)\) の正規分布
\(\mathcal{N}(0,I(\theta_0))\) に近づく．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
両辺を整理
</p>
<blockquote>
<p>
\(n\to\infty\) のとき
</p>
<div>
\begin{equation}
  \sqrt{n}I(\theta_0)(\hat\theta^*-\theta_0)
  \sim \mathcal{N}(0,I(\theta_0))\quad(n\to\infty)
\end{equation}

</div>

<p>
であるので
</p>
<div>
\begin{align}
  \sqrt{n}(\hat\theta^*-\theta_0)
  \sim &\mathcal{N}\left(0,I(\theta_0)^{-1}I(\theta_0)I(\theta_0)^{-1}\right)\\
       &= \mathcal{N}\left(0,I(\theta_0)^{-1}\right)
\end{align}

</div>

<p>
となる．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org42739e0">
<h2 id="org42739e0">漸近正規性にもとづく区間推定</h2>
<div class="outline-text-2" id="text-org42739e0">
</div>
</section>
<section id="slide-orga402ae3">
<h3 id="orga402ae3">推定量の漸近正規性</h3>
<ul>
<li><p>
<b>漸近正規性</b>
</p>
<blockquote>
<p>
多くの推定量 \(\hat{\theta}\) の分布は正規分布で近似できる
</p>
</blockquote>
<ul>
<li>モーメントに基づく記述統計量は漸近正規性をもつ</li>
<li>最尤推定量は広い範囲の確率分布に対して漸近正規性をもつ</li>
<li>いずれも中心極限定理にもとづく</li>

</ul></li>
<li>正規分布を用いて近似的に信頼区間を構成可能</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4afa064">
<h3 id="org4afa064">漸近正規性にもとづく区間推定</h3>
<ul>
<li><p>
推定量の分布
</p>
<blockquote>
<p>
観測データ数 \(n\) が十分大きいとき，
母数 \(\theta\) の推定量 \(\hat\theta\) が
</p>
<div>
\begin{equation}
  \mathbb{E}[\hat\theta]=\theta_{0},\quad
  \mathrm{Var}(\hat\theta)=s^{2}
\end{equation}

</div>

<p>
の正規分布で近似できるとする．
</p>
</blockquote></li>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
母数 \(\theta\) の \(1{-}\alpha\) 信頼区間は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\hat{\theta}-z_{1{-}\alpha/2}\cdot s,\;
    \hat{\theta}+z_{1{-}\alpha/2}\cdot s
  \right]  
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge64ce16">
<h3 id="orge64ce16">標本平均の区間推定</h3>
<ul>
<li><p>
定理 (標本平均の漸近正規性)
</p>
<blockquote>
<p>
確率分布が2次のモーメントを持てば，
分布の平均 \(\mu\) の推定量である標本平均
</p>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>

<p>
は漸近正規性をもつ．
確率変数 \(X\) の標準偏差の一致推定量を \(\hat\sigma\) とすれば, 
\(\phi\) を標準正規分布の確率密度関数として，
任意の \(a\le b\) に対して以下が成立する．
</p>
<div>
\begin{equation}
  P\left(a\le\frac{\sqrt{n}(\bar{X}-\mu)}{\hat\sigma}
    \le b\right)\to\int_a^b\phi(x)dx\quad(n\to\infty)
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
\(\sigma\) の一致推定量
</p>
<blockquote>
<p>
例えば不偏分散
</p>
<div>
\begin{equation}
  \hat{\sigma}^{2}=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^2
\end{equation}

</div>

<p>
の平方根を用いれば良い．
</p>
</blockquote></li>
<li><p>
推定量の分散
</p>
<blockquote>
<div>
\begin{equation}
  \mathrm{Var}(\bar{X})
  =\frac{\sigma^{2}}{n}
  \simeq
  =\frac{\hat{\sigma}^{2}}{n}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
平均 \(\mu\) の \(1{-}\alpha\) 信頼区間は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\bar{X}-z_{1{-}\alpha/2}\cdot\frac{\hat{\sigma}}{\sqrt{n}},\;
    \bar{X}+z_{1{-}\alpha/2}\cdot\frac{\hat{\sigma}}{\sqrt{n}}\right]
\end{equation}

</div>
</blockquote>
<ul>
<li>サンプル数 \(n\) が十分大きい場合に近似的に正しい</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org2ac96bd">
<h3 id="org2ac96bd">最尤推定量の区間推定</h3>
<ul>
<li><p>
定理 (最尤推定量の漸近正規性)
</p>
<blockquote>
<p>
観測データ数 \(n\) が十分大きいとき，
1次元母数 \(\theta\) を含む連続分布の最尤推定量 \(\hat\theta\) は
</p>
<div>
\begin{equation}
  \mathbb{E}[\hat\theta]=\theta_{0},\quad
  \mathrm{Var}(\hat\theta)=\frac{1}{nI(\hat\theta)}
\end{equation}

</div>

<p>
の正規分布で近似できる．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
信頼区間の構成
</p>
<blockquote>
<p>
母数 \(\theta\) の \(1{-}\alpha\) 信頼区間は以下で構成される．
</p>
<div>
\begin{equation}
  \left[\hat{\theta}-z_{1{-}\alpha/2}\cdot\frac{1}{\sqrt{nI(\hat\theta)}},\;
    \hat{\theta}+z_{1{-}\alpha/2}\cdot\frac{1}{\sqrt{nI(\hat\theta)}}\right]  
\end{equation}

</div>
</blockquote>
<ul>
<li>サンプル数 \(n\) が十分大きい場合に近似的に正しい</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org9502e27" data-background="#fef4f4">
<h2 id="org9502e27">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb906bac" data-background="#fef4f4">
<h3 id="orgb906bac">練習問題</h3>
<ul>
<li>選挙の投票率を調べるために，
400人にアンケートを実施した結果，
320人が投票に行き，残りが行かなかったと答えた．
以下の問に答えよ．
<ul>
<li>投票率を最尤推定しなさい．</li>
<li>投票率の最尤推定量の分散を求めよ．</li>
<li>投票率の0.9信頼区間を求めよ．
ただし \(z_{0.95}=1.64\) として計算せよ．</li>
<li><p>
ヒント: 以下のような確率変数を考えるとよい．
</p>
<blockquote>
<div>
\begin{equation}
  X=
  \begin{cases}
    1, &\text{投票に行った}\\
    0, &\text{行かなかった}
  \end{cases}
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org3bf2d3c" data-background="#fef4f4">
<h3 id="org3bf2d3c">解答例</h3>
<ul>
<li><p>
確率質量関数
</p>
<blockquote>
<p>
投票率を \(\theta\) とし，
確率変数 \(X\) の確率質量関数を以下で定義する．
</p>
<div>
\begin{align}
  f(1)&=\theta\\
  f(0)&=1-\theta
\end{align}

</div>

<p>
以下のようにまとめられる．(他にも書き方はある)
</p>
<div>
\begin{equation}
  f(x)=\theta^{x}(1-\theta)^{1-x}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
対数尤度
</p>
<blockquote>
<div>
\begin{align}
  \ell(\theta)
  &=\sum_{i=1}^{400}\log f(X_{i})\\
  &=\sum_{i=1}^{400}
    \left\{
    X_{i}\log\theta+(1-X_{i})\log(1-\theta)
    \right\}\\
  &=n\bar{X}\log\theta+n(1-\bar{X})\log(1-\theta)
\end{align}

</div>

<p>
ただし \(\bar{X}\) は標本平均．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
最尤推定量
</p>
<blockquote>
<div>
\begin{align}
  \ell'(\hat\theta)
  &=\frac{n\bar{X}}{\hat\theta}-\frac{n(1-\bar{X})}{1-\hat\theta}=0\\
  \hat\theta&=\bar{X}
\end{align}

</div>
</blockquote></li>
<li><p>
推定値
</p>
<blockquote>
<div>
\begin{equation}
  \hat\theta
  =\bar{X}
  =\frac{320}{400}=0.8
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
Fisher 情報量を用いた場合
</p>
<blockquote>
<div>
\begin{align}
  I(\theta)
  &=\mathbb{E}
    \left[
    -\frac{\partial^{2}}{\partial\theta^{2}}\log f(X;\theta)
    \right]\\
  &=\mathbb{E}
    \left[
    \frac{X}{\theta^{2}}+\frac{(1-X)}{(1-\theta)^{2}}
    \right]\\
  &=\frac{1}{\theta}+\frac{1}{(1-\theta)}
    =\frac{1}{\theta(1-\theta)}
\end{align}

</div>

<p>
したがって真の母数が \(\theta_{0}\) のときの推定量の分散は以下で与えられる．
</p>
<div>
\begin{equation}
  \mathrm{Var}(\hat\theta)=\frac{\theta_{0}(1-\theta_{0})}{n}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
標本平均の性質を用いた場合
</p>
<blockquote>
<p>
確率変数の平均と分散は
</p>
<div>
\begin{align}
  \mathbb{E}[X]
  &=1\times\theta+0\times(1-\theta)
    =\theta\\
  \mathrm{Var}(X)
  &=\mathbb{E}[X^{2}]-\mathbb{E}[X]^{2}\\
  &=\theta-\theta^2=\theta(1-\theta)
\end{align}

</div>

<p>
であるので，
真の母数が \(\theta_{0}\) のときの推定量の分散は以下で与えられる．
</p>
<div>
\begin{equation}
  \mathrm{Var}(\hat\theta)
  =\mathrm{Var}(\bar{X})
  =\frac{\theta_{0}(1-\theta_{0})}{n}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
推定量の分散の一致推定量
</p>
<blockquote>
<p>
真の値 \(\theta_{0}\) の代理として
最尤推定量 \(\hat\theta\) を用いる
</p>
<div>
\begin{equation}
  s^{2}
  =\frac{\hat\theta(1-\hat\theta)}{n}
  =\frac{0.8\times0.2}{400}=4\times 10^{-4}
\end{equation}

</div>
<div>
\begin{equation}
  s
  =0.02
\end{equation}

</div>
</blockquote></li>
<li><p>
0.9信頼区間 (90%信頼区間)
</p>
<blockquote>
<div>
\begin{equation}
  \left[
    \hat\theta-z_{0.95}\cdot s,\;
    \hat\theta+z_{0.95}\cdot s
  \right]
  =[0.7672,\;0.8328]
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgf8430a0">
<h2 id="orgf8430a0">今回のまとめ</h2>
<ul>
<li>最尤法の考え方</li>
<li>最尤推定量の性質
<ul>
<li>一致性</li>
<li>漸近正規性</li>

</ul></li>
<li>最尤推定量による区間推定
<ul>
<li>標本平均の場合</li>
<li>母数推定の場合</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org04aa3d5">
<h3 id="org04aa3d5">注意</h3>
<ul>
<li>確認テスト (講義10の中)
<ul>
<li>推定の計算問題 (数値をよく確認すること)</li>
<li>期間と時間制限に注意</li>
<li>試験の意味を考えて誠実な対応をすること</li>
<li>ネットワーク環境等には自身で配慮すること</li>
<li>過去問などで手を動かしてから受けることをお勧め</li>

</ul></li>
<li>次週は理解度確認</li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
