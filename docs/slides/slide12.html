<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>最尤推定に基づく検定</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">最尤推定に基づく検定</h1>
</div>
<div class="talk-subtitle">
    <p>確率・統計 - 第12講</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-orgb26fffb">
<h2 id="orgb26fffb">前回のおさらい</h2>
<ul>
<li>統計的仮説検定</li>
<li>正規分布を用いた検定
<ul>
<li>平均値の差の検定</li>
<li>平均値の検定</li>

</ul></li>
<li>分散未知の正規分布を用いた検定
<ul>
<li>平均値の検定</li>
<li>平均値の差の検定</li>
<li>分散の検定</li>
<li>分散の比の検定</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb576d3f">
<h3 id="orgb576d3f">統計的仮説検定</h3>
<ul>
<li>ある現象・母集団に対して仮定された仮説の真偽を
データに基づいて統計的に検証する方法</li>
<li>推定と大きく異なるのは，
母集団の分布に対して何らかの仮説を考えるところ</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7accbfb">
<h3 id="org7accbfb">検定における仮説</h3>
<ul>
<li><p>
<b>帰無仮説</b> \(H_0\)
</p>
<blockquote>
<p>
検定統計量の分布を予想するために立てる仮説
</p>
</blockquote></li>
<li><p>
<b>対立仮説</b> \(H_{1}\) 
</p>
<blockquote>
<p>
&ldquo;帰無仮説が誤っているときに起こりうるシナリオ&rdquo;として想定する仮説
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgaf320b5">
<h3 id="orgaf320b5">検定の基本的手続き</h3>
<ol>
<li>仮説を立てる</li>
<li>仮説のもとで <b>検定統計量</b> が従う <b>帰無分布</b> を調べる</li>
<li>実際のデータから検定統計量の値を計算する</li>
<li>計算された検定統計量の値が
仮説が正しいときに十分高い確率で
得られるかどうかを判断する
<ul>
<li><b>棄却域</b> を用いる方法</li>
<li><b>\(p\) 値</b> を計算する方法</li>

</ul></li>

</ol>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgfecd4ae">
<h3 id="orgfecd4ae">検定の用語</h3>
<ul>
<li>仮説の判定
<ul>
<li>帰無仮説を <b>棄却</b> : 帰無仮説は誤っていると判断すること</li>
<li>帰無仮説を <b>受容</b> : 帰無仮説を積極的に棄却できないこと</li>

</ul></li>
<li>検定の誤り
<ul>
<li><b>第一種過誤</b> : &ldquo;正しい帰無仮説を棄却する&rdquo; 誤り</li>
<li><b>第二種過誤</b> : &ldquo;誤った帰無仮説を受容する&rdquo; 誤り</li>

</ul></li>
<li>検定の設計
<ul>
<li><b>サイズ</b> : &ldquo;第一種過誤が起きる確率&rdquo; を小さく</li>
<li><b>検出力</b> : &ldquo;第二種過誤が起きない確率&rdquo; を大きく</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgba36e07">
<h3 id="orgba36e07">有意水準と\(p\) 値</h3>
<ul>
<li><p>
<b>有意水準</b>
</p>
<blockquote>
<p>
第一種過誤が起きる確率(サイズ)として許容する上限
</p>
</blockquote></li>
<li><p>
<b>\(p\) 値 (有意確率)</b>
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(p\) 値)}
  =\min\{\alpha\in(0,1)|\text{\(T\) が\(R_{\alpha}\)に含まれる}\}
\end{equation}

</div>
</blockquote>
<ul>
<li>検定統計量 \(T\) が棄却域 \(R_{\alpha}\) に含まれる有意水準 \(\alpha\) の最小値</li>

</ul></li>
<li><p>
有意水準と \(p\) 値の関係
</p>
<blockquote>
<p>
\(p\) 値が有意水準未満のときに帰無仮説を棄却する
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgf627c71">
<h3 id="orgf627c71">正規分布を用いた平均値の検定</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
確率変数列の平均値が \(\mu\) と等しいか検定せよ．
</p>
<div>
\begin{equation}
  X_1,X_2,\dotsc,X_n 
\end{equation}

</div>
</blockquote></li>
<li><p>
検定問題
</p>
<blockquote>
<div>
\begin{equation}
  X_i=\theta+\varepsilon_{i},
  \quad i=1,\dotsc,n
  \qquad \varepsilon_{i}\sim\mathcal{N}(0,\sigma^{2})
\end{equation}

</div>

<p>
を観測値の確率モデル (\(\sigma^{2}\) は既知) とするとき
</p>
<div>
\begin{equation}
  H_{0}: \theta=\mu
  \quad\text{vs}\quad
  H_{1}: \theta\not=\mu
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  T=\frac{\sqrt{n}(\bar{X}-\mu)}{\sigma}
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は標準正規分布</li>

</ul></li>
<li><p>
棄却域 (両側検定の場合)
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}
  =
  \left(-\infty,-z_{1{-}\alpha/2}\right)
  \cup
  \left(z_{1{-}\alpha/2},\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org891639d">
<h3 id="org891639d">正規分布を用いた平均値の差の検定</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
2つの確率変数列の平均値が等しいか検定せよ．
</p>
<div>
\begin{equation}
  X_1,X_2,\dotsc,X_n, \qquad
  Y_1,Y_2,\dotsc,Y_m 
\end{equation}

</div>
</blockquote></li>
<li><p>
検定問題
</p>
<blockquote>
<div>
\begin{align}
  X_i&=\theta_{1}+\varepsilon_{1i},
       \quad i=1,\dotsc,n
       \qquad \varepsilon_{1i}\sim\mathcal{N}(0,\sigma^{2})\\
  Y_j&=\theta_{2}+\varepsilon_{2j},
       \quad j=1,\dotsc,m
       \qquad \varepsilon_{2j}\sim\mathcal{N}(0,\sigma^{2})
\end{align}

</div>

<p>
を観測値の確率モデル (\(\sigma^{2}\) は既知) とするとき
</p>
<div>
\begin{equation}
  H_{0}: \theta_{1}=\theta_{2}
  \quad\text{vs}\quad
  H_{1}: \theta_{1}\not=\theta_{2}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  T=\sqrt{\frac{nm}{n+m}}\frac{\bar{X}-\bar{Y}}{\sigma}
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は標準正規分布</li>

</ul></li>
<li><p>
棄却域 (両側検定の場合)
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}
  =
  \left(-\infty,-z_{1{-}\alpha/2}\right)
  \cup
  \left(z_{1{-}\alpha/2},\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgfd8d2af">
<h3 id="orgfd8d2af">両側検定と片側検定</h3>
<ul>
<li>対立仮説によって棄却域の形は変わりうる

<ul>
<li><p>
両側検定:
</p>
<blockquote>
<p>
棄却域がある定数 \(a < b\) によって
</p>
<div>
\begin{equation}
  (-\infty,a)\cup(b,\infty)
\end{equation}

</div>
</blockquote></li>
<li><p>
片側検定
</p>
<blockquote>
<p>
棄却域がある定数 \(a\) によって
</p>
<div>
\begin{align}
  &(a,\infty)&&\text{(右片側検定)}\\
  &(-\infty,a)&&\text{(左片側検定)}
\end{align}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<div class="leftcol" id="org8e1e474">

<div id="org785174d" class="figure">
<p><img src="figs/cr_one.png" alt="cr_one.png" width="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>右片側検定の棄却域</p>
</div>

</div>
<div class="rightcol" id="org376cb5b">

<div id="org01058ae" class="figure">
<p><img src="figs/cr_two.png" alt="cr_two.png" width="100%" />
</p>
<p><span class="figure-number">Figure 2: </span>両側検定の棄却域</p>
</div>

</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org26e51eb">
<h3 id="org26e51eb">分散未知の正規分布の平均値の検定</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
確率変数列の平均値が \(\mu_{0}\) と等しいか検定せよ．
</p>
<div>
\begin{equation}
  X_{1},X_{2},\dotsc,X_{n} 
\end{equation}

</div>
</blockquote></li>
<li><p>
検定問題
</p>
<blockquote>
<div>
\begin{equation}
  X_{i}=\mu+\varepsilon_{i},
  \quad i=1,\dotsc,n
  \qquad \varepsilon_{i}\sim\mathcal{N}(0,\sigma^{2})
\end{equation}

</div>

<p>
を観測値の確率モデル (\(\sigma^{2}\) は <b>未知</b>) とするとき
</p>
<div>
\begin{equation}
  H_{0}: \mu=\mu_{0}
  \quad\text{vs}\quad
  H_{1}: \mu\neq\mu_{0}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>平均と分散の推定量
<ul>
<li><p>
標本平均
</p>
<blockquote>
<div>
\begin{equation}
  \bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
\end{equation}

</div>
</blockquote></li>
<li><p>
不偏分散
</p>
<blockquote>
<div>
\begin{equation}
  s^{2}=\frac{1}{n{-}1}\sum_{i=1}^n(X_i-\bar{X})^{2}
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>帰無仮説のもとでの推定量の性質
<ul>
<li>標本平均と不偏分散は互いに独立</li>
<li><p>
標本平均 (標準正規分布)
</p>
<blockquote>
<div>
\begin{equation}
  \frac{\bar{X}-\mu_{0}}{\sigma/\sqrt{n}}
  \sim \mathcal{N}(0,1)
\end{equation}

</div>
</blockquote></li>
<li><p>
不偏分散 (\(\chi^{2}\) 分布)
</p>
<blockquote>
<div>
\begin{equation}
  \frac{(n{-}1)s^{2}}{\sigma^{2}}
  \sim \chi^{2}(n{-}1)
\end{equation}

</div>
</blockquote></li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  T=\frac{\sqrt{n}(\bar{X}-\mu_0)}{s}
\end{equation}

</div>
</blockquote>
<ul>
<li><p>
帰無分布は自由度 \(n{-}1\) の \(t\) 分布
</p>
<blockquote>
<div>
\begin{equation}
  \text{(\(t\) 分布)}
  =
  \frac{\text{(標準正規分布)}}
  {\sqrt{(\chi^{2}\text{分布})/\text{(自由度)}}}
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
棄却域 (両側検定の場合)
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,-t_{1{-}\alpha/2}(n{-}1)\right)
  \cup\left(t_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org4979717">
<h3 id="org4979717">平均値の差の検定</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
2つの確率変数列の平均値が等しいか検定せよ．
</p>
<div>
\begin{equation}
  X_{1},X_{2},\dotsc,X_{m}, \qquad
  Y_{1},Y_{2},\dotsc,Y_{n} 
\end{equation}

</div>
</blockquote></li>
<li><p>
検定問題
</p>
<blockquote>
<div>
\begin{align}
  X_i&=\mu_{1}+\varepsilon_{1i},
       \quad i=1,\dotsc,m
  && \varepsilon_{1i}\sim\mathcal{N}(0,\sigma_{1}^{2})\\
  Y_j&=\mu_{2}+\varepsilon_{2j},
       \quad j=1,\dotsc,n
  && \varepsilon_{2j}\sim\mathcal{N}(0,\sigma_{2}^{2})
\end{align}

</div>

<p>
を観測値の確率モデル (\(\sigma_{i}^{2}\) は <b>未知</b>) とするとき
</p>
<div>
\begin{equation}
  H_{0}: \mu_{1}=\mu_{2}
  \quad\text{vs}\quad
  H_{1}: \mu_{1}\neq\mu_{2}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  T=\frac{\bar{X}-\bar{Y}}{\sqrt{s_{1}^{2}/m+s_{2}^{2}/n}}
  \quad
  \text{(\(s_{1}^{2},s_{2}^{2}\)は\(X,Y\)の不偏分散)}
\end{equation}

</div>
</blockquote>
<ul>
<li><p>
帰無分布は近似的に自由度 \(\hat{\nu}\) の \(t\) 分布 (<b>Welchの近似</b>)
</p>
<blockquote>
<div>
\begin{equation}
  \hat{\nu}
  =\frac{(s_{1}^{2}/m+s_{2}^{2}/n)^{2}}
  {(s_{1}^{2}/m)^{2}/(m{-}1)+(s_{2}^{2}/n)^{2}/(n{-}1)}
\end{equation}

</div>
</blockquote></li>

</ul></li>
<li><p>
棄却域 (両側検定の場合)
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,-t_{1{-}\alpha/2}(\hat{\nu})\right)
  \cup\left(t_{1{-}\alpha/2}(\hat{\nu}),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orga984e13">
<h3 id="orga984e13">分散の検定</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
確率変数列の分散が \(\sigma_0^{2}\) と等しいか検定せよ．
</p>
<div>
\begin{equation}
  X_{1},X_{2},\dotsc,X_{n} 
\end{equation}

</div>
</blockquote></li>
<li><p>
検定問題
</p>
<blockquote>
<div>
\begin{equation}
  X_{i}=\mu+\varepsilon_{i},
  \quad i=1,\dotsc,n
  \qquad \varepsilon_{i}\sim\mathcal{N}(0,\sigma^{2})
\end{equation}

</div>

<p>
を観測値の確率モデルとするとき
</p>
<div>
\begin{equation}
  H_0:\sigma^{2}=\sigma_0^{2}
  \quad\text{vs}\quad
  H_{1}:\sigma^{2}\neq\sigma_0^{2}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  \chi^{2}=\frac{(n{-}1)s^{2}}{\sigma_0^{2}}
  \quad
  \text{(\(s^{2}\)は\(X\)の不偏分散)}
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は自由度 \(n{-}1\) の \(\chi^{2}\) 分布</li>

</ul></li>
<li><p>
棄却域 (両側検定の場合)
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(0,\chi^{2}_{\alpha/2}(n{-}1)\right)
  \cup\left(\chi^{2}_{1{-}\alpha/2}(n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgddb891a">
<h3 id="orgddb891a">分散の比の検定</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
2つの確率変数列の分散が等しいか検定せよ．
</p>
<div>
\begin{equation}
  X_{1},X_{2},\dotsc,X_{m}, \qquad
  Y_{1},Y_{2},\dotsc,Y_{n} 
\end{equation}

</div>
</blockquote></li>
<li><p>
検定問題
</p>
<blockquote>
<div>
\begin{align}
  X_i&=\mu_{1}+\varepsilon_{1i},
       \quad i=1,\dotsc,m
  && \varepsilon_{1i}\sim\mathcal{N}(0,\sigma_{1}^{2})\\
  Y_j&=\mu_{2}+\varepsilon_{2j},
       \quad j=1,\dotsc,n
  && \varepsilon_{2j}\sim\mathcal{N}(0,\sigma_{2}^{2})
\end{align}

</div>

<p>
を観測値の確率モデルとするとき
</p>
<div>
\begin{equation}
  H_0:\sigma_{1}^{2}=\sigma_{2}^{2}
  \quad\text{vs}\quad
  H_{1}:\sigma_{1}^{2}\neq\sigma_{2}^{2}
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  F=\frac{s_{1}^{2}}{s_{2}^{2}}
  \quad
  \text{(\(s_{1}^{2},s_{2}^{2}\)は\(X,Y\)の不偏分散)}
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は自由度 \(m{-}1,n{-}1\) の \(F\) 分布</li>

</ul></li>
<li><p>
棄却域 (両側検定の場合)
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(0,F_{\alpha/2}(m{-}1,n{-}1)\right)
  \cup\left(F_{1{-}\alpha/2}(m{-}1,n{-}1),\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-org1600ff3" data-background="#fef4f4">
<h2 id="org1600ff3">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgcf086fb" data-background="#fef4f4">
<h3 id="orgcf086fb">練習問題</h3>
<ul>
<li><p>
以下の問に答えよ．
</p>
<blockquote>
<p>
携帯電話の利用料(月額)を調べた．
18〜25歳の 80 人では平均 7400 円(標準偏差 2500 円)，
30〜40歳の 100 人では平均 8200 円(標準偏差 2800 円)であった．
それぞれの年齢層の利用料は正規分布に従い，
上記の標準偏差は正確に求められているとする．
</p>

<p>
このとき，
利用料の平均に違いがあると言えるかを
有意水準 0.05 で考えなさい．
</p>
</blockquote>
<ul>
<li>\(z_{0.95}=1.64, z_{0.975}=1.96\)</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orgbe67ea0">
<h2 id="orgbe67ea0">漸近正規性にもとづく検定</h2>
<div class="outline-text-2" id="text-orgbe67ea0">
</div>
</section>
<section id="slide-orge3b16bc">
<h3 id="orge3b16bc">推定量の漸近正規性</h3>
<ul>
<li><p>
漸近正規性 (データ数が多いときの性質)
</p>
<blockquote>
<p>
多くの推定量 \(\hat{\theta}\) の分布は正規分布で近似できる
</p>
</blockquote>
<ul>
<li>モーメントに基づく記述統計量は漸近正規性をもつ</li>
<li>最尤推定量は広い範囲の確率分布に対して漸近正規性をもつ</li>
<li>いずれも中心極限定理にもとづく</li>

</ul></li>
<li>信頼区間と同様に正規分布を用いて検定を考えることができる</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgd5f9a4a">
<h3 id="orgd5f9a4a">最尤推定量の漸近正規性</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
\(f(x)>0\)
が連続で2階微分可能ならば
\(\sqrt{n}(\hat\theta^*-\theta_0)\)
は
\(n\to\infty\)
で正規分布
\(\mathcal{N}(0,I(\theta_0)^{-1})\)
に近づく．
</p>
</blockquote>
<ul>
<li>\(\hat\theta^*\) は最尤推定量，\(\theta_{0}\) は真の母数</li>
<li>観測データが十分多ければ，
最尤推定量の分散(誤差)は
Cramer-Rao 下界に一致する</li>
<li><p>
Fisher 情報量 (\(f\) : 確率質量関数または確率密度関数)
</p>
<blockquote>
<div>
\begin{align}
  I(\theta_0)
  &=\mathbb{E}_{\theta_0}
    \left[
    -\frac{\partial^{2}}{\partial\theta^{2}}\log f(X;\theta_0)
    \right]
  \\
  &=\mathbb{E}_{\theta_0}\left[\left(
    \frac{\partial}{\partial\theta}\log f(X;\theta_0)\right)^{2}\right]
\end{align}

</div>
</blockquote></li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge68a516">
<h3 id="orge68a516">最尤推定量の検定</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
\(\theta_0\) を既知の定数として，
母数 \(\theta\) が真の値 \(\theta_0\) であるか否かを検定する
</p>
<div>
\begin{equation}
  H_0:\theta=\theta_0\quad\text{vs}\quad H_{1}:\theta\neq\theta_0
\end{equation}

</div>
</blockquote>
<ul>
<li>上記は両側検定</li>
<li>片側検定も同様に考えることができる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge595a2f">
<h3 id="orge595a2f">考え方</h3>
<ul>
<li><p>
最尤推定量の性質
</p>
<blockquote>
<p>
観測データ数 \(n\) が十分大きいとき，
1次元母数 \(\theta\) を含む連続分布の最尤推定量 \(\hat\theta\) は
</p>
<div>
\begin{equation}
  \mathbb{E}[\hat\theta]=\theta_{0},\quad
  \mathrm{Var}(\hat\theta)=\frac{1}{nI(\theta_{0})}
\end{equation}

</div>

<p>
の正規分布で近似できる．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orge08ac37">
<h3 id="orge08ac37">\(Z\) 検定 (正規分布による検定)</h3>
<ul>
<li><p>
検定統計量
</p>
<blockquote>
<div>
\begin{equation}
  Z
  =
  \sqrt{nI(\theta_{0})}(\hat{\theta}-\theta_{0})
\end{equation}

</div>
</blockquote>
<ul>
<li>帰無分布は標準正規分布</li>
<li>Fisher 情報量は真の値 \(\theta_{0}\) で計算すればよい</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
有意水準 \(\alpha\) の両側検定
</p>
<blockquote>
<p>
\(z_{1{-}\alpha/2}\) : 標準正規分布の \(1{-}\alpha/2\) 分位点
</p>
</blockquote></li>
<li><p>
棄却域
</p>
<blockquote>
<div>
\begin{equation}
  R_{\alpha}=
  \left(-\infty,-z_{1{-}\alpha/2}\right)
  \cup\left(z_{1{-}\alpha/2},\infty\right)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1a1eff8">
<h3 id="org1a1eff8">例題 (McNemar検定)</h3>
<ul>
<li><p>
問題
</p>
<blockquote>
<p>
A社とB社の開発した2つの文字認識機械がある．
\(n\) 個の文字に対してその性能を調べたところ
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">1</th>
<th scope="col" class="org-left">2</th>
<th scope="col" class="org-left">3</th>
<th scope="col" class="org-left">&#x2026;</th>
<th scope="col" class="org-left">n</th>
<th scope="col" class="org-right">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">A社</td>
<td class="org-left">○</td>
<td class="org-left">○</td>
<td class="org-left">×</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">○</td>
<td class="org-right">98.1%</td>
</tr>

<tr>
<td class="org-left">B社</td>
<td class="org-left">×</td>
<td class="org-left">○</td>
<td class="org-left">○</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">○</td>
<td class="org-right">98.0%</td>
</tr>
</tbody>
</table>
<p>
のような正答率を示した．
このときA社の機械はB社より優れていると言えるだろうか？
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li>試験した結果によって判断は異なるべき <br />
(n=10,000)</li>

</ul>
<div class="leftcol" id="org4cc5685">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">Aが正解</th>
<th scope="col" class="org-right">Aが誤り</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Bが正解</td>
<td class="org-right">9800</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-left">Bが誤り</td>
<td class="org-right">10</td>
<td class="org-right">190</td>
</tr>
</tbody>
</table>

</div>
<div class="rightcol" id="org0f219d1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">Aが正解</th>
<th scope="col" class="org-right">Aが誤り</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Bが正解</td>
<td class="org-right">9610</td>
<td class="org-right">190</td>
</tr>

<tr>
<td class="org-left">Bが誤り</td>
<td class="org-right">200</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>

</div>
<div class="slide-footer"><br></div>


</section>
</section>
<section>
<section id="slide-orgbdd553e" data-background="#fef4f4">
<h2 id="orgbdd553e">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org0755759" data-background="#fef4f4">
<h3 id="org0755759">練習問題</h3>
<ul>
<li><p>
以下の問に答えよ
</p>
<blockquote>
<p>
A社とB社の開発した2つの文字認識機械がある．
10,000文字に対してその性能を調べたところ
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">Aが正解</th>
<th scope="col" class="org-right">Aが誤り</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Bが正解</td>
<td class="org-right">9500</td>
<td class="org-right">180</td>
</tr>

<tr>
<td class="org-left">Bが誤り</td>
<td class="org-right">220</td>
<td class="org-right">100</td>
</tr>
</tbody>
</table>
<p>
のような正答率を示した．
このときA社の機械はB社より優れていると言えるだろうか？
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org993b6de">
<h2 id="org993b6de">今回のまとめ</h2>
<ul>
<li>最尤推定量を用いた検定
<ul>
<li>最尤推定量の漸近正規性</li>
<li>正規分布を用いた検定に帰着</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
