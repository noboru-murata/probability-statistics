<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>統計的有意性とp値</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">統計的有意性とp値</h1>
</div>
<div class="talk-subtitle">
    <p>検定の基本的な考え方</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-org412b046">
<h2 id="org412b046">検定の考え方</h2>
<div class="outline-text-2" id="text-org412b046">
</div>
</section>
<section id="slide-org7fcd26f">
<h3 id="org7fcd26f">統計的仮説検定</h3>
<ul>
<li>ある現象・母集団に対して仮定された仮説の真偽を
データに基づいて統計的に検証する方法</li>
<li>検定の基本的手続き
<ol>
<li>帰無仮説(および対立仮説)を立てる</li>
<li>データから計算できる統計量を設定する
<ul>
<li><b>検定統計量</b> という</li>

</ul></li>
<li>帰無仮説のもとで検定統計量が従う標本分布を求める
<ul>
<li><b>帰無分布</b> という</li>

</ul></li>
<li>実際のデータから検定統計量の値を計算する</li>
<li>計算された検定統計量の値が
仮説が正しいときに十分高い確率で
得られるかどうかを判断する
<ul>
<li>この閾値を <b>有意水準</b> という</li>

</ul></li>

</ol></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf0c4b50">
<h3 id="orgf0c4b50">例題</h3>
<ul>
<li>表の出る確率が高くなるよう細工したコインを見つける問題を考える
<ul>
<li class="fragment appear">何回か投げてみる</li>
<li class="fragment appear">表が裏より出やすければ「いかさま」と判断する</li>
<li class="fragment appear">どのくらい表が出たら怪しいと考えられるだろうか?</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgcdd0dfb">
<h3 id="orgcdd0dfb">問題</h3>
<ul>
<li>いかさまのないコイン(表の出る確率が0.5)を20回投げたとき，
表が \(k\) 回出る確率を求めなさい</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1992b61">
<h3 id="org1992b61">解答</h3>
<ul>
<li><p>
以下の式で計算される
</p>
<blockquote>
<div>
\begin{equation}
  P(\text{表の回数}=k)
  =
  \left(20\atop k\right)
  0.5^{k} (1-0.5)^{20-k}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="org58d5679" class="figure">
<p><img src="figs/pval_null_n_20.png" alt="pval_null_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまのないコインの場合</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7759e9a">
<h3 id="org7759e9a">問題</h3>
<ul>
<li>いかさまのあるコイン(表の出る確率が0.6)を20回投げたとき，
表が \(k\) 回出る確率を求めなさい</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org1eda146">
<h3 id="org1eda146">解答</h3>
<ul>
<li><p>
以下の式で計算される
</p>
<blockquote>
<div>
\begin{equation}
  P(\text{表の回数}=k)
  =
  \left(20\atop k\right)
  0.6^{k} (1-0.6)^{20-k}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="org64c6c6a" class="figure">
<p><img src="figs/pval_alt_n_20.png" alt="pval_alt_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 2: </span>いかさまのあるコインの場合</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="org310c13e" class="figure">
<p><img src="figs/pval_both_n_20.png" alt="pval_both_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまの有無による違い</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb019e87">
<h3 id="orgb019e87">問題</h3>
<ul>
<li>いかさまのないコインを20回投げたとき，
15回以上表が出る確率はいくつか</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9a1045d">
<h3 id="org9a1045d">解答</h3>
<ul>
<li><p>
以下の式で計算される
</p>
<blockquote>
<div>
\begin{equation}
  P(\text{表の回数}\ge 15)
  =
  \sum_{k=15}^{20}\left(20\atop k\right)
  0.5^{k} (1-0.5)^{20-k}
  =
  0.02
\end{equation}

</div>
</blockquote></li>
<li>「20回投げて表が出た回数」を検定統計量と考える</li>
<li>「20回投げて15回以上表が出たら怪しい」と考える
<ul>
<li>怪しいと考える検定統計量の領域を <b>棄却域</b> という</li>

</ul></li>
<li>この方策で「いかさまのないコイン」を間違えて怪しいとしてしまう確率は0.02である
<ul>
<li><b>第一種の過誤</b> (type-I error) という</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org3cb4c55" class="figure">
<p><img src="figs/pval_null_cum_n_20.png" alt="pval_null_cum_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまのないコインの場合</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgce5f779">
<h3 id="orgce5f779">問題</h3>
<ul>
<li>いかさまのあるコインを20回投げたとき，
15回以上表が出る確率はいくつか</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgc38627a">
<h3 id="orgc38627a">解答</h3>
<ul>
<li><p>
以下の式で計算される
</p>
<blockquote>
<div>
\begin{equation}
  P(\text{表の回数}\ge 15)
  =
  \sum_{k=15}^{20}\left(20\atop k\right)
  0.6^{k} (1-0.6)^{20-k}
  =
  0.13
\end{equation}

</div>
</blockquote>
<ul>
<li>この方法で「いかさまのあるコイン」を見分けられる確率は13%程度となる</li>
<li>これを検出力 (power) という</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="org997d7b9" class="figure">
<p><img src="figs/pval_alt_cum_n_20.png" alt="pval_alt_cum_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまのあるコインの場合</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="orga327ba2" class="figure">
<p><img src="figs/pval_both_cum_n_20.png" alt="pval_both_cum_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまの有無による違い</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org9469508">
<h3 id="org9469508">問題</h3>
<ul>
<li>もっとあからさまにいかさまのあるコイン(表の出る確率が0.9)を20回投げたとき，
15回以上表が出る確率はいくつか</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb23efd3">
<h3 id="orgb23efd3">解答</h3>
<ul>
<li><p>
以下の式で計算される
</p>
<blockquote>
<div>
\begin{equation}
  P(\text{表の回数}\ge 15)
  =
  \sum_{k=15}^{20}\left(20\atop k\right)
  0.9^{k} (1-0.9)^{20-k}
  =
  0.98
\end{equation}

</div>
</blockquote>
<ul>
<li>この方法で「あからさまにいかさまのあるコイン」を見分けられる確率は98%程度となる</li>
<li>対立仮説によって検出力は異なる</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="org8ca1092" class="figure">
<p><img src="figs/pval_alt2_cum_n_20.png" alt="pval_alt2_cum_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまのあるコインの場合</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="orged46c6f" class="figure">
<p><img src="figs/pval_both2_cum_n_20.png" alt="pval_both2_cum_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまの有無による違い</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgadabc0d" class="figure">
<p><img src="figs/pval_power_n_20.png" alt="pval_power_n_20.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>対立仮説による検出力の違い (15回以上をいかさまとする場合)</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org12d5030">
<h3 id="org12d5030">問題</h3>
<ul>
<li>いかさまのないコインを100回投げたとき，
60回以上表が出る確率はいくつか</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgb082171">
<h3 id="orgb082171">解答</h3>
<ul>
<li><p>
以下の式で計算される
</p>
<blockquote>
<div>
\begin{equation}
  P(\text{表の回数}\ge 60)
  =
  \sum_{k=60}^{100}\left(100\atop k\right)
  0.5^{k} (1-0.5)^{100-k}
  =
  0.028
\end{equation}

</div>
</blockquote></li>
<li>異なる検定統計量「100回投げて表が出た回数」を考えている</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org45cfc33">
<h3 id="org45cfc33">問題</h3>
<ul>
<li>いかさまのあるコインを100回投げたとき，
60回以上表が出る確率はいくつか</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgcf40b69">
<h3 id="orgcf40b69">解答</h3>
<ul>
<li><p>
以下の式で計算される
</p>
<blockquote>
<div>
\begin{equation}
  P(\text{表の回数}\ge 60)
  =
  \sum_{k=60}^{100}\left(100\atop k\right)
  0.6^{k} (1-0.6)^{100-k}
  =
  0.543
\end{equation}

</div>
</blockquote>
<ul>
<li>同じ仮説だとしても検定統計量によって検出力は異なる．</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>

<div id="org14e4569" class="figure">
<p><img src="figs/pval_both_cum_n_100.png" alt="pval_both_cum_n_100.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>いかさまの有無による違い</p>
</div>
<div class="slide-footer"><br></div>
</section>
<section>

<div id="orgf50c352" class="figure">
<p><img src="figs/pval_power_n_100.png" alt="pval_power_n_100.png" height="100%" />
</p>
<p><span class="figure-number">Figure 1: </span>対立仮説による検出力の違い (15回以上をいかさまとする場合)</p>
</div>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org7d15277">
<h3 id="org7d15277">問題</h3>
<ul>
<li>以下の問に答えなさい
<ul>
<li>100個のコインがある</li>
<li>このうち10個には&ldquo;あるいかさま&rdquo;が施されている</li>
<li>ある検定統計量を用いて有意水準0.05の検定を考える</li>
<li>設定した検定統計量の検出力は0.8であることがわかっている</li>
<li>このときどの程度のいかさまを見破ることができるだろうか?</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org228aa38">
<h3 id="org228aa38">解答例</h3>
<ul>
<li>以下おおざっぱな考え方を示す
<ul>
<li>いかさまを検出できる確率は0.8なので，
平均的には\(10\times0.8=8\)個の
いかさまコインを見付けられる</li>
<li>有意水準0.05なので，
平均的には\(90\times0.05=4.5\)個
誤っていかさまコインだと判定してしまう</li>
<li>見破ったと考える12.5個のうち，
本当にいかさまをしているのは8個なので，
64%しか当たらないことになる</li>

</ul></li>
<li>実際の状況に合わせて検定の意味を考える必要がある</li>

</ul>
<div class="slide-footer"><br></div>

</section>
</section>
<section>
<section id="slide-org88df56f">
<h2 id="org88df56f">p値とその誤解</h2>
<div class="outline-text-2" id="text-org88df56f">
</div>
</section>
<section id="slide-orge1453e5">
<h3 id="orge1453e5">p値とは</h3>
<blockquote>
<p>
おおざっぱにいうと，
p値とは特定の統計モデルのもとで，
データの統計的要約
(たとえば，2グループ比較での標本平均の差)
が観察された値と等しいか，それよりも極端な値をとる確率である．
</p>
</blockquote>
<ul>
<li><b>p値</b> は観測された値を使った検定の第一種の過誤の確率として定義される</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgec2d1d0">
<h3 id="orgec2d1d0">良くある正しくない記述</h3>
<ul>
<li>p値は帰無仮説が正しい確率である</li>
<li>p値はそのデータが偶然で得られた確率である</li>
<li>検定結果が有意であるので帰無仮説は必ず棄却すべきである</li>
<li>検定結果が有意でないので帰無仮説を必ず採択すべきである</li>
<li>2つのp値を比べてp値が小さい方の効果が大きいと判断する</li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-org0ea691a">
<h3 id="org0ea691a">ASAの提言</h3>
<ul>
<li>American Statistical Association
<a href="https://www.amstat.org/asa/files/pdfs/p-valuestatement.pdf">https://www.amstat.org/asa/files/pdfs/p-valuestatement.pdf</a></li>
<li>日本計量生物学会による和訳
<a href="https://www.biometrics.gr.jp/news/all/ASA.pdf">https://www.biometrics.gr.jp/news/all/ASA.pdf</a></li>

</ul>
<div class="slide-footer"><br></div>

</section>
<section id="slide-orgfd60ccb">
<h3 id="orgfd60ccb">提言の要旨</h3>
<ul>
<li><p>
その1
</p>
<blockquote>
<p>
p値はデータと特定の統計モデルが矛盾する程度をしめす指標のひとつである
</p>
</blockquote>
<ul class="fragment appear">
<li>統計モデルはいくつもの仮定を含む</li>
<li>帰無仮説は仮定の1つにすぎない</li>
<li>p値が小さければ<br />
単に <del>データと帰無仮説の矛盾の程度が大きい</del> ではなく<br />
統計モデルの仮定のどれかが間違っている</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
その2
</p>
<blockquote>
<p>
p値は，調べている仮説が正しい確率や，データが偶然のみで得られた確率を測るものではない
</p>
</blockquote>
<ul class="fragment appear">
<li>誤差をともなってばらつくのはデータである</li>
<li>仮説や真の値は確率的でない</li>
<li>データが偶然のみで得られることは統計モデルの仮定の一つである</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
その3
</p>
<blockquote>
<p>
科学的な結論や，ビジネス，政策における決定は，p値がある値を超えたかどうかにのみ基づくべきではない
</p>
</blockquote>
<ul class="fragment appear">
<li>データ解析や科学的推論を機械的で明白なルールに貶めるようなやり方は
誤った思い込みや貧弱な意思決定につながる</li>
<li>科学的推論には研究デザイン，測定の室，外部のエビデンス，データ解析の背後にある
仮定の妥当性が重要である</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
その4
</p>
<blockquote>
<p>
適正な推測のためには，すべてを報告する透明性が必要である
</p>
</blockquote>
<ul class="fragment appear">
<li>p値や関連する解析は選択して報告してはいけない</li>
<li>研究の中で調べる仮説の数，データの選択基準，実行したすべての統計解析，計算したすべてのp値を開示すべきである</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
その5
</p>
<blockquote>
<p>
p値や統計的有意性は，効果の大きさや結果の重要性を意味しない
</p>
</blockquote>
<ul class="fragment appear">
<li>統計的に有意であることは科学的に意味にあることと同義ではない</li>
<li>どんなに小さな効果でもサンプルサイズが大きかったり測定精度が十分高ければ小さなp値になるし，その逆もしかり</li>
<li>効果の推定値が同じ大きさでも，推定の精度が異なれば異なったp値となる</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
その6
</p>
<blockquote>
<p>
p値は，それだけでは統計モデルや仮説に関するエビデンスの，よい指標とはならない
</p>
</blockquote>
<ul class="fragment appear">
<li>背景情報や外部のエビデンスがなければ，p値は限られた情報しか提供しない</li>
<li>p値が大きくても帰無仮説を好む証拠とはならない</li>
<li>p値を計算したらデータ解析は終わりではない</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,
overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
